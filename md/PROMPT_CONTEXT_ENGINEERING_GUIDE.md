# ðŸŽ¨ ì¸ë„¤ì¼ ìƒì„± ì‹œìŠ¤í…œ - í”„ë¡¬í”„íŠ¸ & ì»¨í…ìŠ¤íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ê°€ì´ë“œ

## ðŸ“‹ ëª©ì°¨
1. [ê°œìš”](#ê°œìš”)
2. [í”„ë¡¬í”„íŠ¸ vs ì»¨í…ìŠ¤íŠ¸ ì—”ì§€ë‹ˆì–´ë§](#í”„ë¡¬í”„íŠ¸-vs-ì»¨í…ìŠ¤íŠ¸-ì—”ì§€ë‹ˆì–´ë§)
3. [ì‹œìŠ¤í…œ ì›Œí¬í”Œë¡œìš°](#ì‹œìŠ¤í…œ-ì›Œí¬í”Œë¡œìš°)
4. [4ì¸ ì—ì´ì „íŠ¸ êµ¬ì„±](#4ì¸-ì—ì´ì „íŠ¸-êµ¬ì„±)
5. [í•µì‹¬ êµ¬í˜„ ì „ëžµ](#í•µì‹¬-êµ¬í˜„-ì „ëžµ)
6. [LangGraph ë©€í‹°ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ](#langgraph-ë©€í‹°ì—ì´ì „íŠ¸-ì‹œìŠ¤í…œ)
7. [ì‹¤ì „ ì½”ë“œ ì˜ˆì‹œ](#ì‹¤ì „-ì½”ë“œ-ì˜ˆì‹œ)
8. [UI/UX ê³ ë ¤ì‚¬í•­](#uiux-ê³ ë ¤ì‚¬í•­)

---

## ê°œìš”

ìœ íŠœë¸Œ ì¸ë„¤ì¼ ìžë™ ìƒì„± ì„œë¹„ìŠ¤ì—ì„œ **í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§**ê³¼ **ì»¨í…ìŠ¤íŠ¸ ì—”ì§€ë‹ˆì–´ë§**ì„ í™œìš©í•˜ì—¬, ì‚¬ìš©ìžê°€ ë³µìž¡í•œ ê¸°ìˆ  í”„ë¡¬í”„íŠ¸ë¥¼ ëª°ë¼ë„ ìžì—°ì–´ ëŒ€í™”ë§Œìœ¼ë¡œ ê³ í’ˆì§ˆ ì¸ë„¤ì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.

### í•µì‹¬ ëª©í‘œ
- âœ… ê¸°ìˆ  í”„ë¡¬í”„íŠ¸ë¥¼ ì‚¬ìš©ìž ì¹œí™”ì ì¸ í•œêµ­ì–´ë¡œ ë²ˆì—­
- âœ… ì‚¬ìš©ìž í”¼ë“œë°± ë¬´ì œí•œ ë°˜ì˜ (ë§Œì¡±í•  ë•Œê¹Œì§€)
- âœ… ë ˆí¼ëŸ°ìŠ¤ ì´ë¯¸ì§€ì™€ ìŠ¤í¬ë¦½íŠ¸ ì»¨í…ìŠ¤íŠ¸ ìµœëŒ€ í™œìš©
- âœ… **LangGraph ê¸°ë°˜ 4ì¸ ë©€í‹°ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ**ìœ¼ë¡œ ê³ í’ˆì§ˆ ë³´ìž¥

---

## í”„ë¡¬í”„íŠ¸ vs ì»¨í…ìŠ¤íŠ¸ ì—”ì§€ë‹ˆì–´ë§

### ðŸŽ¯ í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§
**"ì–´ë–»ê²Œ AIì—ê²Œ ìš”ì²­í•  ê²ƒì¸ê°€"**

AIì—ê²Œ ì£¼ëŠ” ì§ˆë¬¸/ì§€ì‹œë¬¸ì„ ìµœì í™”í•˜ëŠ” ìž‘ì—….

#### ë³¸ ì‹œìŠ¤í…œ ì ìš© ì‚¬ë¡€
```
âœ… ê¸°ìˆ  í”„ë¡¬í”„íŠ¸ â†’ í•œêµ­ì–´ ë²ˆì—­
âŒ "A Korean news anchor, frontal medium shot, dark studio..."
âœ… "ì–´ë‘ìš´ ë‰´ìŠ¤ë£¸ì—ì„œ ì•µì»¤ê°€ ì •ë©´ì„ ë°”ë¼ë³´ëŠ” êµ¬ë„ë¡œ ì´¬ì˜í• ê²Œìš”."

âœ… ì‚¬ìš©ìž í”¼ë“œë°± â†’ í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
"ë°°ê²½ ë°ê²Œ" â†’ dark studio â†’ bright studio

âœ… ì—ì´ì „íŠ¸ë³„ ì „ë¬¸í™”ëœ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
```

---

### ðŸ—‚ï¸ ì»¨í…ìŠ¤íŠ¸ ì—”ì§€ë‹ˆì–´ë§
**"ë¬´ì—‡ì„ AIì—ê²Œ ì „ë‹¬í•  ê²ƒì¸ê°€"**

AIê°€ ì°¸ì¡°í•  ë°°ê²½ ì •ë³´ë¥¼ ì„¤ê³„/ê´€ë¦¬í•˜ëŠ” ìž‘ì—….

#### ë³¸ ì‹œìŠ¤í…œ ì ìš© ì‚¬ë¡€
```python
# ì»¨í…ìŠ¤íŠ¸ ê³„ì¸µ êµ¬ì¡°
{
    "ìž…ë ¥_ì»¨í…ìŠ¤íŠ¸": {
        "script_summary": "ì˜ìƒ ìŠ¤í¬ë¦½íŠ¸ ìš”ì•½",
        "keywords": ["ê¸´ê¸‰", "ì†ë³´"],
        "user_request": "ê¸´ë°•í•œ ë‰´ìŠ¤ ëŠë‚Œìœ¼ë¡œ",
        "reference_images": ["ref1.jpg"]
    },
    "ë¶„ì„_ì»¨í…ìŠ¤íŠ¸": {
        "reference_analysis": {
            "composition": "ì •ë©´ êµ¬ë„",
            "colors": ["#FF0000", "#000000"],
            "lighting": "dramatic side lighting"
        }
    },
    "í”¼ë“œë°±_ì»¨í…ìŠ¤íŠ¸": {
        "history": [
            {"feedback": "ë°°ê²½ ë°ê²Œ", "applied": "bright studio"},
            {"feedback": "ì¸ë¬¼ í¬ê²Œ", "applied": "close-up"}
        ]
    }
}
```

**í•µì‹¬**: ë ˆí¼ëŸ°ìŠ¤ ì´ë¯¸ì§€ ë¶„ì„, ìŠ¤í¬ë¦½íŠ¸ ìš”ì•½, í”¼ë“œë°± ížˆìŠ¤í† ë¦¬ë¥¼ ì»¨í…ìŠ¤íŠ¸ë¡œ ì œê³µí•˜ì—¬ ì—ì´ì „íŠ¸ê°€ ë” ì •í™•í•œ ê²°ì •ì„ í•˜ë„ë¡ í•¨.

---

## ì‹œìŠ¤í…œ ì›Œí¬í”Œë¡œìš°

```
[ì‚¬ìš©ìž ìž…ë ¥]
ë ˆí¼ëŸ°ìŠ¤ ì´ë¯¸ì§€ + ìžì—°ì–´ ìš”ì²­ ("ë°ì€ ëŠë‚Œìœ¼ë¡œ")
         â†“
[Copywriter Agent]
ìŠ¤í¬ë¦½íŠ¸ ìš”ì•½ â†’ ì œëª© 3ê°€ì§€ ìƒì„±
         â†“
[ðŸ‘¤ ì‚¬ìš©ìž ì„ íƒ/ìž…ë ¥]
ì œëª© í™•ì •
         â†“
[ë ˆí¼ëŸ°ìŠ¤ ì´ë¯¸ì§€ ë¶„ì„]
ë¹„ì „ ëª¨ë¸ë¡œ êµ¬ë„/ìƒ‰ê°/ì¡°ëª… ì¶”ì¶œ
         â†“
[Prompt Specialist Agent]
Nano Banana Proìš© ê¸°ìˆ  í”„ë¡¬í”„íŠ¸ ìƒì„±
         â†“
[Interaction Agent]
ê¸°ìˆ  í”„ë¡¬í”„íŠ¸ â†’ í•œêµ­ì–´ ìš”ì•½
         â†“
[ðŸ‘¤ ì‚¬ìš©ìž í™•ì¸]
    â†™          â†˜
[í”¼ë“œë°±]      [ìŠ¹ì¸]
    â†“            â†“
(ë‹¤ì‹œ Prompt  [Art Director]
 Specialist)  ìµœì¢… ê²€ìˆ˜
    â†“            â†“
(ë£¨í”„ ë°˜ë³µ)   [ì´ë¯¸ì§€ ìƒì„±]
```

**í•µì‹¬ íŠ¹ì§•**:
- **ìˆœí™˜ ë£¨í”„**: í”¼ë“œë°± â†’ ìˆ˜ì • â†’ í™•ì¸ (ë¬´í•œ ë°˜ë³µ ê°€ëŠ¥)
- **Human-in-the-loop**: ì‚¬ìš©ìž í™•ì¸ ì‹œì ì—ì„œ ëŒ€ê¸°
- **4ì¸ ì „ë¬¸ ì—ì´ì „íŠ¸**: ê°ìž ì—­í•  ë¶„ë‹´

---

## 4ì¸ ì—ì´ì „íŠ¸ êµ¬ì„±

### 1ï¸âƒ£ Copywriter Agent (í…ìŠ¤íŠ¸ ìž‘ê°€)

**ì—­í• **: ìŠ¤í¬ë¦½íŠ¸ ë¶„ì„ â†’ ì¸ë„¤ì¼ í…ìŠ¤íŠ¸ ìƒì„±

**ìž…ë ¥ ì»¨í…ìŠ¤íŠ¸**:
- ìŠ¤í¬ë¦½íŠ¸ ìš”ì•½
- í‚¤ì›Œë“œ
- ì‚¬ìš©ìž í†¤ ìš”ì²­

**í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ**:
```
ë‹¹ì‹ ì€ ìœ íŠœë¸Œ ì¸ë„¤ì¼ í…ìŠ¤íŠ¸ ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.

ì»¨í…ìŠ¤íŠ¸:
- ìŠ¤í¬ë¦½íŠ¸ ìš”ì•½: {summary}
- í‚¤ì›Œë“œ: {keywords}
- ì‚¬ìš©ìž ìš”ì²­: {user_request}

ë¯¸ì…˜: 3ê°€ì§€ ìŠ¤íƒ€ì¼ ì œëª© ìƒì„±
1. ì˜ë¬¸í˜•: "ì´ê²Œ ê°€ëŠ¥í•´?"
2. ì¶©ê²©í˜•: "ê¸´ê¸‰ ì†ë³´!"
3. ìš”ì•½í˜•: "í•µì‹¬ ì •ë¦¬"

í˜•ì‹: ì£¼ì œëª© 15ìž ì´ë‚´, ë¶€ì œëª© 10ìž ì´ë‚´
```

---

### 2ï¸âƒ£ Prompt Specialist Agent (í”„ë¡¬í”„íŠ¸ ì „ë¬¸ê°€) â­

**ì—­í• **: ê¸°ìˆ  í”„ë¡¬í”„íŠ¸ ìƒì„± ë° í”¼ë“œë°± ë°˜ì˜ ìˆ˜ì •

**2ê°€ì§€ ëª¨ë“œ**:

#### ëª¨ë“œ 1: ì´ˆê¸° ìƒì„±
```
ìž…ë ¥ ì»¨í…ìŠ¤íŠ¸:
- í™•ì • í…ìŠ¤íŠ¸: "ê¸´ê¸‰ ì†ë³´! ì¶©ê²© ë°œí‘œ"
- ì‚¬ìš©ìž ìš”ì²­: "ê¸´ë°•í•œ ë‰´ìŠ¤ ëŠë‚Œ"
- ë ˆí¼ëŸ°ìŠ¤ ë¶„ì„: {êµ¬ë„, ìƒ‰ê°, ì¡°ëª…}
- Nano Banana Best Practices (í•„ìˆ˜ ì¤€ìˆ˜)

ì¶œë ¥: Nano Banana Proìš© ì˜ì–´ í”„ë¡¬í”„íŠ¸
```

#### ëª¨ë“œ 2: í”¼ë“œë°± ë°˜ì˜ ìˆ˜ì •
```
ìž…ë ¥:
- í˜„ìž¬ í”„ë¡¬í”„íŠ¸
- ì‚¬ìš©ìž í”¼ë“œë°±: "ë°°ê²½ ë” ë°ê²Œ"

ë³€í™˜ ë¡œì§:
"ë°ê²Œ" â†’ lighting: dark â†’ bright
"í¬ê²Œ" â†’ framing: medium shot â†’ close-up
"ìƒ‰ìƒ" â†’ color scheme ë³€ê²½

ì¶œë ¥: ìˆ˜ì •ëœ í”„ë¡¬í”„íŠ¸
```

**í•µì‹¬**: ì´ ì—ì´ì „íŠ¸ê°€ **ìˆœí™˜ ë…¸ë“œ**ê°€ ë˜ì–´ í”¼ë“œë°± ë£¨í”„ ë‹´ë‹¹!

---

### 3ï¸âƒ£ Interaction Agent (ì†Œí†µ ì—ì´ì „íŠ¸)

**ì—­í• **: ê¸°ìˆ  í”„ë¡¬í”„íŠ¸ â†” í•œêµ­ì–´ ë²ˆì—­

**í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ**:
```
ê¸°ìˆ  í”„ë¡¬í”„íŠ¸:
"A Korean news anchor, frontal medium shot, dark studio 
with red emergency lighting, dramatic contrast..."

â†“ ë²ˆì—­ ê·œì¹™ â†“
- ê¸°ìˆ  ìš©ì–´ ì œê±°: 85mm â†’ í´ë¡œì¦ˆì—…
- ê°ì„± í‘œí˜„: chiaroscuro â†’ ëª…ì•” ëŒ€ë¹„
- ë°˜ë§ ì‚¬ìš©: ~í• ê²Œìš”

ì¶œë ¥:
"ì–´ë‘ìš´ ë‰´ìŠ¤ë£¸ì—ì„œ ì•µì»¤ê°€ ì •ë©´ì„ ë°”ë¼ë³´ëŠ” êµ¬ë„ë¡œ,
ë¹¨ê°„ ì¡°ëª…ìœ¼ë¡œ ê¸´ë°•ê°ì„ ì—°ì¶œí• ê²Œìš”."
```

**Prompt Hiding**: ë³µìž¡í•œ í”„ë¡¬í”„íŠ¸ëŠ” ì‚¬ìš©ìžì—ê²Œ ìˆ¨ê¸°ê³ , ê¸°íš ì˜ë„ë§Œ ì „ë‹¬!

---

### 4ï¸âƒ£ Art Director Agent (ìµœì¢… ê²€ìˆ˜)

**ì—­í• **: í”„ë¡¬í”„íŠ¸ í’ˆì§ˆ ë³´ì¦

**ì²´í¬ë¦¬ìŠ¤íŠ¸**:
- âœ… í…ìŠ¤íŠ¸ì™€ ë¹„ì£¼ì–¼ ì¡°í™”?
- âœ… ê¸°ìˆ ì  ì˜¤ë¥˜ ì—†ìŒ?

---

## í•µì‹¬ êµ¬í˜„ ì „ëžµ

### 1. ë ˆí¼ëŸ°ìŠ¤ ì´ë¯¸ì§€ ë¶„ì„ (ì»¨í…ìŠ¤íŠ¸ ì—”ì§€ë‹ˆì–´ë§)

```python
import base64
from anthropic import Anthropic

async def analyze_reference_image(image_path: str) -> dict:
    """ë¹„ì „ ëª¨ë¸ë¡œ ë ˆí¼ëŸ°ìŠ¤ ë¶„ì„ â†’ ì»¨í…ìŠ¤íŠ¸ ìƒì„±"""
    client = Anthropic()
    
    with open(image_path, "rb") as f:
        image_data = base64.b64encode(f.read()).decode()
    
    response = await client.messages.create(
        model="claude-sonnet-4-20250514",
        messages=[{
            "role": "user",
            "content": [
                {
                    "type": "image",
                    "source": {
                        "type": "base64",
                        "media_type": "image/jpeg",
                        "data": image_data
                    }
                },
                {
                    "type": "text",
                    "text": """ì´ ì¸ë„¤ì¼ì„ ë¶„ì„í•˜ì—¬ JSON ì¶œë ¥:
{
  "composition": "êµ¬ë„ (ì˜ˆ: ì •ë©´, 3ë¶„í• )",
  "dominant_colors": ["#FF0000", "#000000"],
  "lighting": "ì¡°ëª… ìŠ¤íƒ€ì¼",
  "mood": "ë¶„ìœ„ê¸°"
}"""
                }
            ]
        }]
    )
    
    import json
    return json.loads(response.content[0].text)

# í™œìš©
analysis = await analyze_reference_image("ref.jpg")
# â†’ Prompt Specialistì—ê²Œ ì»¨í…ìŠ¤íŠ¸ë¡œ ì „ë‹¬
```

---

### 2. í”¼ë“œë°± ížˆìŠ¤í† ë¦¬ ê´€ë¦¬ (ì»¨í…ìŠ¤íŠ¸ ëˆ„ì )

```python
class FeedbackHistory:
    def __init__(self):
        self.history = []
    
    def add(self, feedback: str, applied: str):
        self.history.append({
            "iteration": len(self.history) + 1,
            "feedback": feedback,
            "applied": applied
        })
    
    def get_context(self) -> str:
        """ëˆ„ì  í”¼ë“œë°±ì„ ì»¨í…ìŠ¤íŠ¸ë¡œ ë³€í™˜"""
        if not self.history:
            return "í”¼ë“œë°± ì—†ìŒ"
        
        lines = ["**í”¼ë“œë°± ížˆìŠ¤í† ë¦¬**:"]
        for h in self.history:
            lines.append(f"{h['iteration']}. \"{h['feedback']}\" â†’ {h['applied']}")
        return "\n".join(lines)

# ì‚¬ìš©
fb = FeedbackHistory()
fb.add("ë°°ê²½ ë°ê²Œ", "bright studio")
fb.add("ì¸ë¬¼ í¬ê²Œ", "close-up")

context = fb.get_context()
# ì¶œë ¥:
# **í”¼ë“œë°± ížˆìŠ¤í† ë¦¬**:
# 1. "ë°°ê²½ ë°ê²Œ" â†’ bright studio
# 2. "ì¸ë¬¼ í¬ê²Œ" â†’ close-up
```

---

## LangGraph ë©€í‹°ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ

### ðŸ¤” LangGraphê°€ ë­”ê°€ìš”?

**LangGraph**ëŠ” ì—¬ëŸ¬ AI ì—ì´ì „íŠ¸ê°€ í˜‘ì—…í•˜ëŠ” **ìƒíƒœ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°**ë¥¼ ë§Œë“œëŠ” í”„ë ˆìž„ì›Œí¬ìž…ë‹ˆë‹¤.

#### ì™œ í•„ìš”í•œê°€?

ì¼ë°˜ Python ì½”ë“œë¡œ ë©€í‹°ì—ì´ì „íŠ¸ êµ¬í˜„ ì‹œ:
```python
# âŒ ìˆ˜ë™ìœ¼ë¡œ ìƒíƒœ ì „ë‹¬ (ë³µìž¡í•¨)
text = copywriter(script)
selected = user_select(text)
analysis = analyze_ref(images)
prompt = specialist(selected, analysis)  # ë§¤ë²ˆ ì „ë‹¬
korean = interaction(prompt)
if feedback:
    prompt = specialist(prompt, feedback)  # ë‹¤ì‹œ ì „ë‹¬
    korean = interaction(prompt)
    # ë°˜ë³µ...
```

LangGraph ì‚¬ìš© ì‹œ:
```python
# âœ… State ìžë™ ê´€ë¦¬ (ê°„ë‹¨í•¨)
app = workflow.compile()
result = app.invoke(initial_state)
# Stateê°€ ìžë™ìœ¼ë¡œ ê° ë…¸ë“œì— ì „ë‹¬/ì—…ë°ì´íŠ¸
# ìˆœí™˜ ë£¨í”„ë„ ìžë™ ì²˜ë¦¬
```

---

### ðŸ“¦ LangGraph í•µì‹¬ ê°œë… 3ê°€ì§€

#### 1. State (ìƒíƒœ)
ëª¨ë“  ì—ì´ì „íŠ¸ê°€ ê³µìœ í•˜ëŠ” ë°ì´í„° ì €ìž¥ì†Œ.

```python
from typing import TypedDict, List, Dict

class ThumbnailState(TypedDict):
    # ìž…ë ¥
    script_summary: str
    keywords: List[str]
    user_natural_request: str
    reference_images: List[str]
    
    # ì¤‘ê°„ ê²°ê³¼
    text_options: List[Dict]
    selected_text: Dict
    reference_analysis: Dict
    
    # í”„ë¡¬í”„íŠ¸
    technical_prompt: str      # Prompt Specialist ìƒì„±
    korean_summary: str         # Interaction ë²ˆì—­
    
    # í”¼ë“œë°±
    user_feedback: str
    feedback_history: List[Dict]
    is_confirmed: bool
    
    # ìµœì¢…
    final_prompt: str
    generated_image_path: str
```

**ë™ìž‘ ë°©ì‹**:
- ê° ë…¸ë“œëŠ” Stateë¥¼ ë°›ìŒ
- ë…¸ë“œê°€ State ìˆ˜ì •
- ìˆ˜ì •ëœ Stateê°€ ë‹¤ìŒ ë…¸ë“œë¡œ ìžë™ ì „ë‹¬

---

#### 2. Node (ë…¸ë“œ)
ê° ì—ì´ì „íŠ¸ì˜ ì‹¤í–‰ í•¨ìˆ˜. Stateë¥¼ ìž…ë ¥ë°›ì•„ ìˆ˜ì • í›„ ë°˜í™˜.

```python
def copywriter_node(state: ThumbnailState) -> ThumbnailState:
    """í…ìŠ¤íŠ¸ ìƒì„±"""
    # Stateì—ì„œ í•„ìš”í•œ ë°ì´í„° ì½ê¸°
    summary = state["script_summary"]
    keywords = state["keywords"]
    
    # LLM í˜¸ì¶œí•˜ì—¬ í…ìŠ¤íŠ¸ ìƒì„±
    text_options = generate_text(summary, keywords)
    
    # State ì—…ë°ì´íŠ¸
    state["text_options"] = text_options
    
    return state  # ìˆ˜ì •ëœ State ë°˜í™˜
```

**í•µì‹¬**: í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ëŠ” í•­ìƒ `(state) -> state`

---

#### 3. Edge (ì—£ì§€)
ë…¸ë“œ ê°„ ì—°ê²°. ì‹¤í–‰ ìˆœì„œ ì •ì˜.

**2ê°€ì§€ íƒ€ìž…**:

##### A. ìˆœì°¨ ì—£ì§€ (ë¬´ì¡°ê±´ ë‹¤ìŒìœ¼ë¡œ)
```python
workflow.add_edge("copywriter", "prompt_specialist")
# copywriter ì™„ë£Œ â†’ ë¬´ì¡°ê±´ prompt_specialist ì‹¤í–‰
```

##### B. ì¡°ê±´ë¶€ ì—£ì§€ (ìƒí™©ì— ë”°ë¼ ë¶„ê¸°)
```python
def check_confirmation(state):
    if state["is_confirmed"]:
        return "art_director"  # ìŠ¹ì¸ â†’ ë‹¤ìŒ
    else:
        return "prompt_specialist"  # í”¼ë“œë°± â†’ ë‹¤ì‹œ

workflow.add_conditional_edges(
    "interaction",  # ì´ ë…¸ë“œ í›„
    check_confirmation,  # ì¡°ê±´ í•¨ìˆ˜
    {
        "art_director": "art_director",
        "prompt_specialist": "prompt_specialist"  # ë£¨í”„!
    }
)
```

---

### ðŸ”„ í”¼ë“œë°± ë£¨í”„ êµ¬í˜„ ì›ë¦¬

**í•µì‹¬**: ì¡°ê±´ë¶€ ì—£ì§€ë¡œ ìˆœí™˜ êµ¬ì¡° ë§Œë“¤ê¸°

```
Prompt Specialist â†’ Interaction â†’ ì‚¬ìš©ìž í™•ì¸
        â†‘                              â†“
        â””â”€â”€â”€â”€â”€â”€â”€â”€ í”¼ë“œë°± ìžˆìœ¼ë©´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                (ë‹¤ì‹œ Prompt Specialist)
```

**ì½”ë“œ**:
```python
workflow.add_conditional_edges(
    "interaction",
    lambda state: "art_director" if state["is_confirmed"] 
                  else "prompt_specialist",
    {
        "art_director": "art_director",
        "prompt_specialist": "prompt_specialist"  # ìžê¸° ìžì‹ ìœ¼ë¡œ!
    }
)
```

**ë™ìž‘**:
1. Prompt Specialist: í”„ë¡¬í”„íŠ¸ ìƒì„±
2. Interaction: í•œêµ­ì–´ ë²ˆì—­
3. ì‚¬ìš©ìž í™•ì¸ ëŒ€ê¸°
4. í”¼ë“œë°± ìž…ë ¥ ì‹œ: Stateì— `user_feedback` ì¶”ê°€, `is_confirmed=False`
5. ì¡°ê±´ë¶€ ì—£ì§€: `is_confirmed=False` â†’ Prompt Specialistë¡œ ëŒì•„ê°
6. Prompt Specialist: í”¼ë“œë°± ë°˜ì˜í•˜ì—¬ í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
7. 2ë²ˆë¶€í„° ë°˜ë³µ...

**ë¬´í•œ ë£¨í”„ ê°€ëŠ¥**: ì‚¬ìš©ìžê°€ `is_confirmed=True` ì„¤ì •í•  ë•Œê¹Œì§€ ê³„ì† ë°˜ë³µ!

---

### ðŸ›‘ Human-in-the-loop (ì‚¬ìš©ìž ìž…ë ¥ ëŒ€ê¸°)

**ë¬¸ì œ**: ì‚¬ìš©ìž í™•ì¸ì„ ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ”ë° ì–´ë–»ê²Œ?

**í•´ê²°**: `interrupt_before` ì‚¬ìš©

```python
workflow.add_interrupt("interaction")
# interaction ë…¸ë“œ ì‹¤í–‰ í›„ ìžë™ìœ¼ë¡œ ë©ˆì¶¤
```

**ì‹¤í–‰ íë¦„**:
```python
# 1. ì´ˆê¸° ì‹¤í–‰
app = workflow.compile()
result = app.invoke(initial_state)
# â†’ interactionê¹Œì§€ ì‹¤í–‰ í›„ STOP

# 2. ì‚¬ìš©ìžì—ê²Œ korean_summary ë³´ì—¬ì¤Œ
print(result["korean_summary"])
# "ì–´ë‘ìš´ ë‰´ìŠ¤ë£¸ì—ì„œ..."

# 3. ì‚¬ìš©ìž ìž…ë ¥ ëŒ€ê¸°
user_input = input("í”¼ë“œë°± ë˜ëŠ” 'í™•ì¸': ")

# 4. State ì—…ë°ì´íŠ¸
if user_input == "í™•ì¸":
    result["is_confirmed"] = True
else:
    result["user_feedback"] = user_input
    result["is_confirmed"] = False

# 5. ê³„ì† ì‹¤í–‰
result = app.invoke(result)
# â†’ ì¡°ê±´ë¶€ ì—£ì§€ íŒë‹¨ â†’ ë‹¤ìŒ ë…¸ë“œ ì‹¤í–‰
```

---

### ðŸ“Š ì „ì²´ Graph êµ¬ì„± ì½”ë“œ

```python
from langgraph.graph import StateGraph, END

# 1. State ì •ì˜
class ThumbnailState(TypedDict):
    # ... (ìœ„ì— ì •ì˜í•œ ëŒ€ë¡œ)
    pass

# 2. Graph ì´ˆê¸°í™”
workflow = StateGraph(ThumbnailState)

# 3. ë…¸ë“œ ì¶”ê°€
workflow.add_node("copywriter", copywriter_node)
workflow.add_node("analyze_reference", analyze_reference_node)
workflow.add_node("prompt_specialist", prompt_specialist_node)
workflow.add_node("interaction", interaction_node)
workflow.add_node("art_director", art_director_node)

# 4. ìˆœì°¨ ì—£ì§€
workflow.add_edge("copywriter", "analyze_reference")
workflow.add_edge("analyze_reference", "prompt_specialist")
workflow.add_edge("prompt_specialist", "interaction")

# 5. ì¡°ê±´ë¶€ ì—£ì§€ (í”¼ë“œë°± ë£¨í”„!)
def check_confirmation(state: ThumbnailState):
    if state["is_confirmed"]:
        return "art_director"
    else:
        return "prompt_specialist"  # ìˆœí™˜!

workflow.add_conditional_edges(
    "interaction",
    check_confirmation,
    {
        "art_director": "art_director",
        "prompt_specialist": "prompt_specialist"
    }
)

workflow.add_edge("art_director", END)

# 6. Human-in-the-loop
workflow.add_interrupt("interaction")

# 7. ì‹œìž‘ì 
workflow.set_entry_point("copywriter")

# 8. ì»´íŒŒì¼
app = workflow.compile()
```

---

### ðŸŽ¬ ì‹¤í–‰ ì‹œë‚˜ë¦¬ì˜¤

```python
# ì´ˆê¸° State
initial_state = {
    "script_summary": "ê¸´ê¸‰ ë‰´ìŠ¤ ë°œí‘œ",
    "keywords": ["ì†ë³´", "ì¶©ê²©"],
    "user_natural_request": "ê¸´ë°•í•œ ëŠë‚Œìœ¼ë¡œ",
    "reference_images": ["ref.jpg"],
    "is_confirmed": False
}

# === 1íšŒì°¨ ì‹¤í–‰ ===
result = app.invoke(initial_state)
# Copywriter â†’ Analyze â†’ Prompt Specialist â†’ Interaction
# â†’ STOP (interrupt)

print(result["korean_summary"])
# "ì–´ë‘ìš´ ë‰´ìŠ¤ë£¸ì—ì„œ ì•µì»¤ê°€..."

# ì‚¬ìš©ìž í”¼ë“œë°±
result["user_feedback"] = "ë°°ê²½ ë” ë°ê²Œ"
result["is_confirmed"] = False

# === 2íšŒì°¨ ì‹¤í–‰ ===
result = app.invoke(result)
# Prompt Specialist (ìˆ˜ì •) â†’ Interaction â†’ STOP

print(result["korean_summary"])
# "ë°ì€ ìŠ¤íŠœë””ì˜¤ì—ì„œ ì•µì»¤ê°€..."

# ì‚¬ìš©ìž ìŠ¹ì¸
result["is_confirmed"] = True

# === 3íšŒì°¨ ì‹¤í–‰ ===
result = app.invoke(result)
# Art Director â†’ END

print(result["final_prompt"])
# "A Korean news anchor, bright studio..."
```

---

## ì‹¤ì „ ì½”ë“œ ì˜ˆì‹œ

### ë…¸ë“œ êµ¬í˜„

#### 1. Copywriter Node

```python
from anthropic import Anthropic

def copywriter_node(state: ThumbnailState) -> ThumbnailState:
    client = Anthropic()
    
    prompt = f"""
ìŠ¤í¬ë¦½íŠ¸: {state["script_summary"]}
í‚¤ì›Œë“œ: {state["keywords"]}

3ê°€ì§€ ìŠ¤íƒ€ì¼ ì œëª©ì„ JSONìœ¼ë¡œ:
{{"options": [{{"style": "ì˜ë¬¸í˜•", "main": "...", "sub": "..."}}]}}
"""
    
    response = client.messages.create(
        model="claude-sonnet-4-20250514",
        messages=[{"role": "user", "content": prompt}]
    )
    
    import json
    result = json.loads(response.content[0].text)
    state["text_options"] = result["options"]
    
    return state
```

#### 2. Prompt Specialist Node (í•µì‹¬!)

```python
def prompt_specialist_node(state: ThumbnailState) -> ThumbnailState:
    client = Anthropic()
    
    is_initial = not state.get("technical_prompt")
    
    if is_initial:
        # ì´ˆê¸° ìƒì„±
        prompt = f"""
í…ìŠ¤íŠ¸: {state["selected_text"]}
ìš”ì²­: {state["user_natural_request"]}
ë ˆí¼ëŸ°ìŠ¤: {state["reference_analysis"]}

Nano Banana Pro í”„ë¡¬í”„íŠ¸ ìƒì„±.
"""
    else:
        # ìˆ˜ì •
        prompt = f"""
í˜„ìž¬: {state["technical_prompt"]}
í”¼ë“œë°±: {state["user_feedback"]}

ìˆ˜ì •ëœ í”„ë¡¬í”„íŠ¸ ìƒì„±.
"""
    
    response = client.messages.create(
        model="claude-sonnet-4-20250514",
        messages=[{"role": "user", "content": prompt}]
    )
    
    state["technical_prompt"] = response.content[0].text
    
    # í”¼ë“œë°± ížˆìŠ¤í† ë¦¬ ì¶”ê°€
    if not is_initial:
        if "feedback_history" not in state:
            state["feedback_history"] = []
        state["feedback_history"].append({
            "feedback": state["user_feedback"],
            "applied": "ìˆ˜ì •ë¨"
        })
        state["user_feedback"] = ""
    
    return state
```

#### 3. Interaction Node

```python
def interaction_node(state: ThumbnailState) -> ThumbnailState:
    client = Anthropic()
    
    prompt = f"""
ê¸°ìˆ  í”„ë¡¬í”„íŠ¸: {state["technical_prompt"]}

í•œêµ­ì–´ë¡œ ë²ˆì—­ (2-3ë¬¸ìž¥, ë°˜ë§)
"""
    
    response = client.messages.create(
        model="claude-sonnet-4-20250514",
        messages=[{"role": "user", "content": prompt}]
    )
    
    state["korean_summary"] = response.content[0].text
    return state
```

---

## UI/UX ê³ ë ¤ì‚¬í•­

### 1. í”¼ë“œë°± ížˆìŠ¤í† ë¦¬ í‘œì‹œ

```python
# Stateì— ì €ìž¥ëœ ížˆìŠ¤í† ë¦¬
feedback_history = [
    {"feedback": "ë°°ê²½ ë°ê²Œ", "applied": "bright studio"},
    {"feedback": "ì¸ë¬¼ í¬ê²Œ", "applied": "close-up"}
]

# UI í‘œì‹œ
"""
ðŸ’¬ ìˆ˜ì • ê¸°ë¡
1ï¸âƒ£ "ë°°ê²½ ë°ê²Œ" â†’ ë°ì€ ìŠ¤íŠœë””ì˜¤ë¡œ ë³€ê²½
2ï¸âƒ£ "ì¸ë¬¼ í¬ê²Œ" â†’ í´ë¡œì¦ˆì—…ìœ¼ë¡œ ë³€ê²½
"""
```

### 2. ë¹„ì •ìƒ ë£¨í”„ ê°ì§€

```python
def detect_loop(history: list) -> dict:
    if len(history) < 3:
        return None
    
    recent = [h["feedback"] for h in history[-3:]]
    if len(set(recent)) == 1:  # ê°™ì€ í”¼ë“œë°± 3ë²ˆ
        return {
            "warning": "ê°™ì€ ìš”ì²­ì´ ë°˜ë³µë˜ê³  ìžˆì–´ìš”",
            "suggestion": "ë” êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”"
        }
    return None
```

### 3. UI ëª©ì—…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¸ë„¤ì¼ ë¯¸ë¦¬ë³´ê¸°                  â”‚
â”‚ "ê¸´ê¸‰ ì†ë³´! ì¶©ê²©ì  ë°œí‘œ"         â”‚
â”‚ [ì´ë¯¸ì§€ ì˜ì—­]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ’¬ AIê°€ ì´ë ‡ê²Œ ë§Œë“¤ ì˜ˆì •ì´ì—ìš”:  â”‚
â”‚ ë°ì€ ìŠ¤íŠœë””ì˜¤ì—ì„œ ì•µì»¤ê°€ ì •ë©´ì„  â”‚
â”‚ ì‘ì‹œí•˜ëŠ” í´ë¡œì¦ˆì—… êµ¬ë„ë¡œ...      â”‚
â”‚                                 â”‚
â”‚ ðŸ”„ ìˆ˜ì • ê¸°ë¡:                   â”‚
â”‚ 1. "ë°°ê²½ ë°ê²Œ" â†’ ë³€ê²½ë¨          â”‚
â”‚ 2. "ì¸ë¬¼ í¬ê²Œ" â†’ ë³€ê²½ë¨          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì¶”ê°€ë¡œ ìˆ˜ì •í•  ë¶€ë¶„ì´ ìžˆë‚˜ìš”?     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ì˜ˆ: ìƒ‰ê° ì¢€ ë” ë”°ëœ»í•˜ê²Œ      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ [â† ì´ì „] [âœ… ì´ëŒ€ë¡œ ìƒì„±í•˜ê¸°]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì •ë¦¬

### í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ í™œìš©
- âœ… Prompt Specialist: ê¸°ìˆ  í”„ë¡¬í”„íŠ¸ ìƒì„±
- âœ… Interaction: í•œêµ­ì–´ ë²ˆì—­
- âœ… í”¼ë“œë°± â†’ í”„ë¡¬í”„íŠ¸ ìˆ˜ì • ë¡œì§

### ì»¨í…ìŠ¤íŠ¸ ì—”ì§€ë‹ˆì–´ë§ í™œìš©
- âœ… ë ˆí¼ëŸ°ìŠ¤ ì´ë¯¸ì§€ ë¶„ì„
- âœ… ìŠ¤í¬ë¦½íŠ¸ ìš”ì•½
- âœ… í”¼ë“œë°± ížˆìŠ¤í† ë¦¬ ëˆ„ì 

### LangGraph ë©€í‹°ì—ì´ì „íŠ¸
- âœ… State ìžë™ ê´€ë¦¬
- âœ… ì¡°ê±´ë¶€ ì—£ì§€ë¡œ í”¼ë“œë°± ë£¨í”„ êµ¬í˜„
- âœ… Human-in-the-loopìœ¼ë¡œ ì‚¬ìš©ìž í™•ì¸ ëŒ€ê¸°

**í•µì‹¬**: 4ì¸ ì—ì´ì „íŠ¸ê°€ LangGraph Stateë¥¼ ê³µìœ í•˜ë©° í˜‘ì—…, ì‚¬ìš©ìž í”¼ë“œë°±ì„ ë¬´ì œí•œ ë°˜ì˜!